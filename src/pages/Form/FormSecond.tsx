import { useMemo, useEffect, useState } from 'react';
import { useLocation, useNavigate } from 'react-router-dom';
import type { TelegramWebApp } from "../../types/telegram";
import Input from "../../components/Input";

const tg = window.Telegram?.WebApp as TelegramWebApp | undefined;
const QUESTIONS: Record<string, { title: string; subtitle: string; questions: string[] }> = {
  love: {
    title: "üíñ –î–ª—è –ª—é–±–∏–º–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞",
    subtitle: "–ü–µ—Å–Ω–∏ –æ –ª—é–±–≤–∏, –ø—Ä–∏–∑–Ω–∞–Ω–∏—è, –æ—Ç–Ω–æ—à–µ–Ω–∏—è, —Å–≤–∞–¥—å–±–∞, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, —Ä–æ–º–∞–Ω—Ç–∏–∫–∞",
    questions: [
      "–ö–∞–∫ –∑–æ–≤—É—Ç —Ç–≤–æ–µ–≥–æ –ª—é–±–∏–º–æ–≥–æ? –ï—Å—Ç—å –ª–∏ —É –Ω–µ–≥–æ/–Ω–µ—ë –æ—Å–æ–±–µ–Ω–Ω–æ–µ –ø—Ä–æ–∑–≤–∏—â–µ?",
      "–û–ø–∏—à–∏ –ª—é–±–∏–º–æ–≥–æ/–ª—é–±–∏–º—É—é —Ç—Ä–µ–º—è —Å–ª–æ–≤–∞–º–∏.",
      "–ö–∞–∫ –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å? –ï—Å—Ç—å –ª–∏ —É –≤–∞—à–µ–π –≤—Å—Ç—Ä–µ—á–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è?",
      "–ö–∞–∫–æ–µ –≤–∞—à–µ —è—Ä–∫–æ–µ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ?",
      "–ï—Å—Ç—å –ª–∏ —É –≤–∞—Å –æ—Å–æ–±—ã–µ —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏–ª–∏ \"—Ñ–∏—à–∫–∏\"?",
      "–ó–∞ —á—Ç–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω(–Ω–∞) —ç—Ç–æ–º—É —á–µ–ª–æ–≤–µ–∫—É?",
      "–û —á—ë–º –æ–Ω/–æ–Ω–∞ –º–µ—á—Ç–∞–µ—Ç? –ï—Å—Ç—å –ª–∏ —Å–æ–≤–º–µ—Å—Ç–Ω–∞—è –º–µ—á—Ç–∞?",
      "–ö–∞–∫–∏–µ —Å–ª–æ–≤–∞ –∏–ª–∏ –ø–æ—Å–ª–∞–Ω–∏–µ —Ç—ã —Ö–æ—á–µ—à—å –µ–º—É/–µ–π —Å–∫–∞–∑–∞—Ç—å?",
      "–ï—Å—Ç—å –ª–∏ —É –≤–∞—Å –ª—é–±–∏–º—ã–µ —Ü–∏—Ç–∞—Ç—ã, –æ—Å–æ–±–µ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã?",
      "–ß—Ç–æ –µ—â—ë –≤–∞–∂–Ω–æ —É–ø–æ–º—è–Ω—É—Ç—å –≤ –ø–µ—Å–Ω–µ?",
    ],
  },
  family: {
    title: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –î–ª—è –±–ª–∏–∑–∫–∏—Ö",
    subtitle: "–ú–∞–º–∞, –ø–∞–ø–∞, –±–∞–±—É—à–∫–∞, –¥–µ–¥—É—à–∫–∞, –±—Ä–∞—Ç, —Å–µ—Å—Ç—Ä–∞ ‚Äî –≤—Å—ë –ø—Ä–æ —Å–µ–º—å—é",
    questions: [
      "–î–ª—è –∫–æ–≥–æ –∏–∑ –±–ª–∏–∑–∫–∏—Ö —ç—Ç–∞ –ø–µ—Å–Ω—è?",
      "–ï—Å—Ç—å –ª–∏ –æ—Å–æ–±–æ–µ –∏–º—è –∏–ª–∏ –ø—Ä–æ–∑–≤–∏—â–µ –≤ —Å–µ–º—å–µ?",
      "–û–ø–∏—à–∏ —ç—Ç–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ —Ç—Ä–µ–º—è —Å–ª–æ–≤–∞–º–∏.",
      "–ö–∞–∫–æ–µ –≥–ª–∞–≤–Ω–æ–µ —Å–µ–º–µ–π–Ω–æ–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ?",
      "–ï—Å—Ç—å –ª–∏ —É –≤–∞—à–µ–π —Å–µ–º—å–∏ –æ—Å–æ–±—ã–µ —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏–ª–∏ —Ä–∏—Ç—É–∞–ª—ã?",
      "–ö–∞–∫–∏–µ –¥–æ–±—Ä—ã–µ –∏–ª–∏ —Å–º–µ—à–Ω—ã–µ —Å–µ–º–µ–π–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤—Å–µ–≥–¥–∞ –≤—Å–ø–æ–º–∏–Ω–∞—é—Ç—Å—è?",
      "–ó–∞ —á—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω(–Ω–∞) –±–ª–∏–∑–∫–∏–º?",
      "–ö–∞–∫–∏–µ —Ü–µ–Ω–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –∏–ª–∏ —É—Ä–æ–∫–∏ –∑–∞–ø–æ–º–Ω–∏–ª–∏—Å—å?",
      "–û —á—ë–º –º–µ—á—Ç–∞–µ—Ç —ç—Ç–æ—Ç —á–µ–ª–æ–≤–µ–∫ (–∏–ª–∏ –≤—Å—è —Å–µ–º—å—è)?",
      "–ö–∞–∫–æ–µ –≥–ª–∞–≤–Ω–æ–µ –ø–æ–∂–µ–ª–∞–Ω–∏–µ —Ö–æ—á–µ—à—å –ø–µ—Ä–µ–¥–∞—Ç—å?",
      "–ï—Å—Ç—å –ª–∏ –æ—Å–æ–±–µ–Ω–Ω—ã–µ —Å–µ–º–µ–π–Ω—ã–µ —Å–ª–æ–≤–∞, —à—É—Ç–∫–∏, —Ñ—Ä–∞–∑—ã?",
      "–ß—Ç–æ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–∑–≤—É—á–∞–ª–æ –≤ –ø–µ—Å–Ω–µ?",
    ],
  },
  friends: {
    title: "üéì –î–ª—è –¥—Ä—É–∑–µ–π –∏ –∫–æ–ª–ª–µ–≥",
    subtitle: "–ü–æ–¥–∞—Ä–æ–∫ –¥—Ä—É–≥—É, –∫–æ–ª–ª–µ–≥–µ, —É—á–∏—Ç–µ–ª—é, –≤—ã–ø—É—Å–∫–Ω–æ–π, –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å",
    questions: [
      "–î–ª—è –∫–æ–≥–æ —ç—Ç–∞ –ø–µ—Å–Ω—è ‚Äî –¥—Ä—É–≥, –∫–æ–ª–ª–µ–≥–∞, —É—á–∏—Ç–µ–ª—å, –∫–ª–∞—Å—Å?",
      "–ï—Å—Ç—å –ª–∏ —É –Ω–µ–≥–æ/–Ω–µ—ë –ø—Ä–æ–∑–≤–∏—â–µ –∏–ª–∏ \"–≤–∞—à–µ\" –∏–º—è?",
      "–ö–∞–∫–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ –æ–ø–∏—à–µ—à—å —ç—Ç–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ç–∏–≤?",
      "–ö–∞–∫ –¥–∞–≤–Ω–æ –¥—Ä—É–∂–∏—Ç–µ –∏–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –≤–º–µ—Å—Ç–µ?",
      "–ö–∞–∫–æ–µ —Å–∞–º–æ–µ —è—Ä–∫–æ–µ –æ–±—â–µ–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ?",
      "–ï—Å—Ç—å –ª–∏ –æ–±—â–∏–µ —Ç—Ä–∞–¥–∏—Ü–∏–∏, –∏–Ω—Ç–µ—Ä–µ—Å—ã –∏–ª–∏ –ø—Ä–æ–µ–∫—Ç—ã?",
      "–ö–∞–∫–∏–µ –∑–∞–±–∞–≤–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏–ª–∏ \"–≤–Ω—É—Ç—Ä—è–∫–∏\" –≤—Å–ø–æ–º–∏–Ω–∞—é—Ç—Å—è —á–∞—â–µ –≤—Å–µ–≥–æ?",
      "–ß–µ–º –æ—Å–æ–±–µ–Ω–Ω–æ —Ü–µ–Ω–µ–Ω —ç—Ç–æ—Ç –¥—Ä—É–≥/–∫–æ–ª–ª–µ–≥–∞ –¥–ª—è —Ç–µ–±—è?",
      "–ö–∞–∫–∏–µ –µ–≥–æ/–µ—ë –º–µ—á—Ç—ã, —Ü–µ–ª–∏ –∏–ª–∏ —É—Å–ø–µ—Ö–∏ —Ö–æ—á–µ—à—å –æ—Ç–º–µ—Ç–∏—Ç—å?",
      "–ß—Ç–æ –±—ã —Ç—ã –ø–æ–∂–µ–ª–∞–ª(–∞) —ç—Ç–æ–º—É —á–µ–ª–æ–≤–µ–∫—É –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ç–∏–≤—É?",
      "–ï—Å—Ç—å –ª–∏ –≤–∞—à–∏ –ª–∏—á–Ω—ã–µ —à—É—Ç–∫–∏, —Ü–∏—Ç–∞—Ç—ã, –æ—Å–æ–±–µ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã?",
      "–ß—Ç–æ –µ—â—ë –≤–∞–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –≤ –ø–µ—Å–Ω—é (–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, –ø–æ–∂–µ–ª–∞–Ω–∏—è)?",
    ],
  },
  hero: {
    title: "üéñÔ∏è –û –≥–µ—Ä–æ–µ –∏–ª–∏ —Å–æ–ª–¥–∞—Ç–µ",
    subtitle: "–í–æ–µ–Ω–Ω—ã–µ, –∑–∞—â–∏—Ç–Ω–∏–∫–∏, –≤—Ä–∞—á–∏, —Å–ø–∞—Å–∞—Ç–µ–ª–∏, –≥–µ—Ä–æ–∏",
    questions: [
      "–ö–∞–∫ –∑–æ–≤—É—Ç –≥–µ—Ä–æ—è? –ï—Å—Ç—å –ª–∏ —É –Ω–µ–≥–æ –ø–æ–∑—ã–≤–Ω–æ–π –∏–ª–∏ –ø—Ä–æ–∑–≤–∏—â–µ?",
      "–ö—Ç–æ –æ–Ω ‚Äî –≤–æ–µ–Ω–Ω—ã–π, –≤—Ä–∞—á, —Å–ø–∞—Å–∞—Ç–µ–ª—å? –í —á—ë–º –ø—Ä–æ—è–≤–∏–ª —Å–µ–±—è?",
      "–û—Ç–∫—É–¥–∞ –æ–Ω —Ä–æ–¥–æ–º? –ï—Å—Ç—å –ª–∏ –≤–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –æ –º–µ—Å—Ç–µ, –≥–¥–µ —Å–ª—É–∂–∏–ª –∏–ª–∏ —Ä–∞–±–æ—Ç–∞–ª?",
      "–ö–∞–∫–æ–π —Å–∞–º—ã–π –∑–Ω–∞—á–∏–º—ã–π –ø–æ—Å—Ç—É–ø–æ–∫ –∏–ª–∏ –ø–æ–¥–≤–∏–≥ –æ–Ω —Å–æ–≤–µ—Ä—à–∏–ª?",
      "–ö–∞–∫–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –¥–ª—è –Ω–µ–≥–æ –≤–∞–∂–Ω—ã?",
      "–ï—Å—Ç—å –ª–∏ —É –Ω–µ–≥–æ —Å–∏–º–≤–æ–ª, —Ç–∞–ª–∏—Å–º–∞–Ω –∏–ª–∏ –¥–µ–≤–∏–∑?",
      "–ö—Ç–æ –µ–≥–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç?",
      "–ö–∞–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã –∏–∑ –µ–≥–æ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç–æ–∏—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–ø–æ–º—è–Ω—É—Ç—å?",
      "–ó–∞ —á—Ç–æ –∏—Å–ø—ã—Ç—ã–≤–∞–µ—à—å –∫ –Ω–µ–º—É –≥–æ—Ä–¥–æ—Å—Ç—å –∏–ª–∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å?",
      "–ï—Å—Ç—å –ª–∏ —Å–ª–æ–≤–∞ –∏–ª–∏ —Ñ—Ä–∞–∑—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—á–µ—Ç—Å—è –≤–∫–ª—é—á–∏—Ç—å –≤ –ø–µ—Å–Ω—é?",
      "–ö–∞–∫–æ–µ –≥–ª–∞–≤–Ω–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ —Ç—ã —Ö–æ—á–µ—à—å –ø–µ—Ä–µ–¥–∞—Ç—å —ç—Ç–æ–º—É –≥–µ—Ä–æ—é?",
      "–ö–∞–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –ø–æ–º–æ–≥—É—Ç —Å–¥–µ–ª–∞—Ç—å –ø–µ—Å–Ω—é –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –ª–∏—á–Ω–æ–π?",
    ],
  },
  child: {
    title: "üçº –ü—Ä–æ —Ä–µ–±—ë–Ω–∫–∞",
    subtitle: "–ü–µ—Å–Ω–∏ –¥–ª—è –º–∞–ª—ã—à–µ–π, –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª–µ–π, –≤—ã–ø—É—Å–∫–Ω–æ–π –∏–∑ —Å–∞–¥–∏–∫–∞, –¥–µ—Ç—Å—Ç–≤–æ",
    questions: [
      "–ö–∞–∫ –∑–æ–≤—É—Ç –º–∞–ª—ã—à–∞? –ï—Å—Ç—å –ª–∏ —É –Ω–µ–≥–æ/–Ω–µ—ë –ª–∞—Å–∫–æ–≤–æ–µ –∏–º—è?",
      "–≠—Ç–æ –º–∞–ª—å—á–∏–∫, –¥–µ–≤–æ—á–∫–∞, –¥–≤–æ–π–Ω—è –∏–ª–∏ —Ç—Ä–æ–π–Ω—è?",
      "–ö–æ–≥–¥–∞ —Ä–æ–¥–∏–ª—Å—è –∏–ª–∏ –∫–æ–≥–¥–∞ –∂–¥—ë—Ç–µ –ø–æ—è–≤–ª–µ–Ω–∏—è?",
      "–ö—Ç–æ —Ä–æ–¥–∏—Ç–µ–ª–∏? –ö–∞–∫ –∂–¥–∞–ª–∏ –º–∞–ª—ã—à–∞?",
      "–ö–∞–∫–∏–µ —Å–º–µ—à–Ω—ã–µ –∏–ª–∏ –º–∏–ª—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ –µ—Å—Ç—å —É —Ä–µ–±—ë–Ω–∫–∞?",
      "–ö–∞–∫–∏–µ —á—É–≤—Å—Ç–≤–∞ –∏—Å–ø—ã—Ç–∞–ª–∏ –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Ä–µ–±—ë–Ω–∫–∞?",
      "–û —á—ë–º –º–µ—á—Ç–∞–µ—Ç–µ –¥–ª—è —Å–≤–æ–µ–≥–æ –º–∞–ª—ã—à–∞?",
      "–ö–∞–∫–∏–µ –≤–∞–∂–Ω—ã–µ –ª—é–¥–∏ –±—É–¥—É—Ç —Ä—è–¥–æ–º —Å –Ω–∏–º?",
      "–ö–∞–∫–∏–µ —Å–ª–æ–≤–∞ –ª—é–±–≤–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ö–æ—Ç–∏—Ç–µ —Å–∫–∞–∑–∞—Ç—å –º–∞–ª—ã—à—É?",
      "–ö–∞–∫–æ–µ –≥–ª–∞–≤–Ω–æ–µ –ø–æ–∂–µ–ª–∞–Ω–∏–µ –∏–ª–∏ –Ω–∞–ø—É—Ç—Å—Ç–≤–∏–µ —Ö–æ—Ç–∏—Ç–µ –¥–∞—Ç—å –µ–º—É –≤ –ø–µ—Å–Ω–µ?",
      "–ï—Å—Ç—å –ª–∏ —Å–µ–º–µ–π–Ω—ã–µ —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏–ª–∏ —Ä–µ–ª–∏–∫–≤–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å?",
      "–ö–∞–∫–∏–µ –æ—Å–æ–±—ã–µ —Ñ—Ä–∞–∑—ã, —Å—Ç–∏—à–∫–∏ –∏–ª–∏ –∫–æ–ª—ã–±–µ–ª—å–Ω—ã–µ –∞—Å—Å–æ—Ü–∏–∏—Ä—É—é—Ç—Å—è —Å —Ä–µ–±—ë–Ω–∫–æ–º?",
      "–ß—Ç–æ –µ—â—ë –≤–∞–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –≤ –ø–µ—Å–Ω—é –æ –≤–∞—à–µ–º –º–∞–ª—ã—à–µ?",
    ],
  },
  holiday: {
    title: "üéà –ü—Ä–∞–∑–¥–Ω–∏–∫ –∏ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ",
    subtitle: "–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è, —é–±–∏–ª–µ–π, –ù–æ–≤—ã–π –≥–æ–¥, –ª—é–±–æ–µ —Å–æ–±—ã—Ç–∏–µ",
    questions: [
      "–ö–∞–∫–æ–π –ø—Ä–∞–∑–¥–Ω–∏–∫ –∏–ª–∏ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–º–µ—á–∞–µ—Ç–µ?",
      "–ö—Ç–æ –≥–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π –ø—Ä–∞–∑–¥–Ω–∏–∫–∞? –ö–∞–∫ –µ–≥–æ –∑–æ–≤—É—Ç? –ï—Å—Ç—å –ª–∏ —É –Ω–µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ –∏–º—è?",
      "–ö–∞–∫–∏–µ –≥–ª–∞–≤–Ω—ã–µ —á–µ—Ä—Ç—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –∏–ª–∏ —É–≤–ª–µ—á–µ–Ω–∏—è —É —ç—Ç–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞?",
      "–ö–∞–∫–æ–µ —Å–∞–º–æ–µ –∑–∞–ø–æ–º–∏–Ω–∞—é—â–µ–µ—Å—è –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å —ç—Ç–∏–º –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º?",
      "–ï—Å—Ç—å –ª–∏ –æ—Å–æ–±—ã–µ —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏–ª–∏ —Ä–∏—Ç—É–∞–ª—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —ç—Ç–∏–º —Å–æ–±—ã—Ç–∏–µ–º?",
      "–ö–∞–∫–∏–µ –ø–æ–¥–∞—Ä–∫–∏ –∏–ª–∏ —Å—é—Ä–ø—Ä–∏–∑—ã –æ—Å–æ–±–µ–Ω–Ω–æ —Ä–∞–¥—É—é—Ç –≥–µ—Ä–æ—è –ø—Ä–∞–∑–¥–Ω–∏–∫–∞?",
      "–ö–∞–∫–æ–µ –≥–ª–∞–≤–Ω–æ–µ –ø–æ–∂–µ–ª–∞–Ω–∏–µ —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å?",
      "–ó–∞ —á—Ç–æ —Ü–µ–Ω–∏—Ç–µ –∏–ª–∏ –±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç–µ —ç—Ç–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞?",
      "–ö–∞–∫–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å –ø–µ—Å–Ω–µ–π?",
      "–ï—Å—Ç—å –ª–∏ –≤–∞—à–∏ –ª–∏—á–Ω—ã–µ —Ñ—Ä–∞–∑—ã, —Ç–æ—Å—Ç—ã, —à—É—Ç–∫–∏ –∏–ª–∏ –∫—Ä–∏—á–∞–ª–∫–∏?",
      "–ß—Ç–æ –µ—â—ë –≤–∞–∂–Ω–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –≤ –ø–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω—É—é –ø–µ—Å–Ω—é?",
    ],
  },
  self: {
    title: "–ü—Ä–æ —Å–µ–±—è",
    subtitle: "–õ–∏—á–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, –ø—É—Ç—å, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–æ–Ω–æ–ª–æ–≥",
    questions: [
      "–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç? –ï—Å—Ç—å –ª–∏ —É —Ç–µ–±—è –æ—Å–æ–±–æ–µ –ø—Ä–æ–∑–≤–∏—â–µ?",
      "–ö–∞–∫–∏–º–∏ —Ç—Ä–µ–º—è —Å–ª–æ–≤–∞–º–∏ —Ç—ã –±—ã —Å–µ–±—è –æ–ø–∏—Å–∞–ª(–∞)?",
      "–ß–µ–º —Ç—ã —É–≤–ª–µ–∫–∞–µ—à—å—Å—è –∏–ª–∏ —á—Ç–æ —Ç–µ–±—è –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç?",
      "–ö–∞–∫–∞—è —Ç–≤–æ—è –≥–ª–∞–≤–Ω–∞—è –º–µ—á—Ç–∞ –∏–ª–∏ —Ü–µ–ª—å —Å–µ–π—á–∞—Å?",
      "–ö–∞–∫–∏–º —Å–≤–æ–∏–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ–º —Ç—ã –≥–æ—Ä–¥–∏—à—å—Å—è?",
      "–ö–∞–∫–∏–µ —Ç–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –ø–æ–º–æ–≥–∞—é—Ç —Ç–µ–±–µ –∏–¥—Ç–∏ –≤–ø–µ—Ä—ë–¥?",
      "–° –∫–∞–∫–∏–º–∏ —Ç—Ä—É–¥–Ω–æ—Å—Ç—è–º–∏ —Å—Ç–∞–ª–∫–∏–≤–∞–ª—Å—è(–ª–∞—Å—å) –∏ —á—Ç–æ –∏–∑ –Ω–∏—Ö –≤—ã–Ω–µ—Å(–ª–∞)?",
      "–ö—Ç–æ –∏–ª–∏ —á—Ç–æ –¥–∞—ë—Ç —Ç–µ–±–µ —Å–∏–ª—ã –Ω–µ —Å–¥–∞–≤–∞—Ç—å—Å—è?",
      "–ö–∞–∫–∏–º —Ç—ã –≤–∏–¥–∏—à—å —Å–µ–±—è —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª–µ—Ç?",
      "–ö–∞–∫–æ–π —Å–æ–≤–µ—Ç –∏–∑ –±—É–¥—É—â–µ–≥–æ —Ç—ã –±—ã —Å–µ–±–µ –¥–∞–ª(–∞)?",
      "–ö–∞–∫–æ–µ –≥–ª–∞–≤–Ω–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ —Ö–æ—á–µ—à—å –ø–µ—Ä–µ–¥–∞—Ç—å —Å–µ–±–µ —á–µ—Ä–µ–∑ –ø–µ—Å–Ω—é?",
      "–ï—Å—Ç—å –ª–∏ —É —Ç–µ–±—è –ª–∏—á–Ω—ã–µ —Ü–∏—Ç–∞—Ç—ã, –¥–µ–≤–∏–∑—ã –∏–ª–∏ –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–∏?",
      "–ß—Ç–æ –µ—â—ë –≤–∞–∂–Ω–æ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ —Å–µ–±–µ, —á—Ç–æ–±—ã –ø–µ—Å–Ω—è –±—ã–ª–∞ –ª–∏—á–Ω–æ–π?",
    ],
  },
  heartbreak: {
    title: "üíî –¢—Ä–µ–∫ –¥–ª—è —Ä–∞–∑–±–∏—Ç–æ–≥–æ —Å–µ—Ä–¥—Ü–∞",
    subtitle: "–ë–æ–ª—å, —Ä–∞–∑—Ä—ã–≤, –∫–∞—Ç–∞—Ä—Å–∏—Å, –ø—Ä–æ—â–∞–Ω–∏–µ, –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–µ",
    questions: [
      "–û –∫–æ–º –∏–ª–∏ –æ —á—ë–º —Ç–≤–æ—è –±–æ–ª—å?",
      "–ß—Ç–æ —Å—Ç–∞–ª–æ –ø—Ä–∏—á–∏–Ω–æ–π —Ä–∞–∑—Ä—ã–≤–∞ –∏–ª–∏ –±–æ–ª–∏?",
      "–ö–∞–∫–æ–π –º–æ–º–µ–Ω—Ç –±—ã–ª —Å–∞–º—ã–º —Ç—è–∂—ë–ª—ã–º –∏–ª–∏ –∑–∞–ø–æ–º–Ω–∏–ª—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
      "–ö–∞–∫–∏–µ —ç–º–æ—Ü–∏–∏ —Å–µ–π—á–∞—Å –ø—Ä–µ–æ–±–ª–∞–¥–∞—é—Ç?",
      "–ö–∞–∫–∏–µ —Å–ª–æ–≤–∞ –∏–ª–∏ –º—ã—Å–ª–∏ –∫—Ä—É—Ç–∏–ª–∏—Å—å –≤ –≥–æ–ª–æ–≤–µ –≤ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥?",
      "–ï—Å—Ç—å –ª–∏ —Ñ—Ä–∞–∑—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã —Å–∫–∞–∑–∞—Ç—å —á–µ–ª–æ–≤–µ–∫—É (–∏–ª–∏ —Å–∞–º–æ–º—É —Å–µ–±–µ) —Ç–æ–≥–¥–∞ –∏–ª–∏ —Å–µ–π—á–∞—Å?",
      "–ß—Ç–æ –ø–æ–º–æ–≥–ª–æ –ø–µ—Ä–µ–∂–∏—Ç—å –∏–ª–∏ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç–ø—É—Å—Ç–∏—Ç—å –±–æ–ª—å?",
      "–ß—Ç–æ –±—ã —Ç—ã —Ö–æ—Ç–µ–ª(–∞) –≤—ã–Ω–µ—Å—Ç–∏ –∏–∑ —ç—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–∏?",
      "–ö–∞–∫–æ–µ –≥–ª–∞–≤–Ω–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ –∏–ª–∏ –≤—ã–≤–æ–¥ —Ö–æ—á–µ—Ç—Å—è –≤–ª–æ–∂–∏—Ç—å –≤ –ø–µ—Å–Ω—é?",
    ],
  },
};

function useQuery() {
  return new URLSearchParams(useLocation().search);
}

export default function FormSecond() {
  const query = useQuery();
  const topic = query.get("topic") || "love";
  const data = useMemo(() => QUESTIONS[topic] || QUESTIONS["love"], [topic]);
  const navigate = useNavigate();
  const [showError, setShowError] = useState(false);
  useEffect(() => {
    if (tg) {
      tg.expand();
      tg.ready();
      if (tg.MainButton) {
        tg.MainButton.setParams({
          text: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
        });
        tg.MainButton.show();

        const onClick = () => navigate('/chat');
        if (tg.onEvent) tg.onEvent('mainButtonClicked', onClick);

        return () => {
          if (tg.offEvent) tg.offEvent('mainButtonClicked', onClick);
        };
      }
    }
  }, [navigate]);

    useEffect(() => {
      if (tg) {
        tg.expand();
        tg.ready();
        if (tg.BackButton) {
          tg.BackButton.show();
          tg.BackButton.onClick(() => {
            if (tg.MainButton) tg.MainButton.hide();
            tg.BackButton?.hide(); // —Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥
            navigate('/chat');
          });
        }
      }
      // –û—á–∏—Å—Ç–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
      return () => {
        if (tg?.BackButton) tg.BackButton.onClick(() => {});
      };
    }, [navigate]);

  const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {
    event.preventDefault();
    setShowError(false);

    if (!event.currentTarget.checkValidity()) {
      setShowError(true);
      return;
    }
    const formData = new FormData(event.currentTarget);
    const answers = data.questions.map((_, idx) => formData.get(`q${idx}`));
    const message = `üéµ *–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ —Ç—Ä–µ–∫!*\n\n*–¢–µ–º–∞:* ${data.title}\n\n${data.questions
      .map((q, idx) => `‚ñ´Ô∏è *${q}*\n${answers[idx] || "-"}`)
      .join("\n\n")}`;

    try {
      const botToken = '7919436616:AAF1STWTxGHYhzUGR7mGkgLAGhuCJXWvZiA';
      // –ü–æ–ª—É—á–∞–µ–º chat_id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram WebApp
      const chatId = tg?.initDataUnsafe?.user?.id;
      if (!chatId) throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å chat_id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');

      const response = await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
        method: 'POST',
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          chat_id: chatId,
          text: message,
          parse_mode: "Markdown",
        }),
      });

      if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è');

      navigate("/success");
    } catch (error) {
      setShowError(true);
      console.log(error);
    }
  };

  return (
    <div className="min-h-screen w-full bg-gradient-to-br from-[#23232b] via-[#18191d] to-black">
      <div className="max-w-xl mx-auto py-14 px-4 text-white">
        <h1
          className="font-bold mb-2 uppercase text-center text-2xl tracking-[0.25em] text-white"
          style={{
            textShadow: "rgba(0, 0, 0) 0px 5px 45px, rgb(0, 0, 0) 0px 1px 9px",
            fontFamily: "'Montserrat', 'Arial', sans-serif",
            fontWeight: 700,
            letterSpacing: "0.25em",
            WebkitTextStroke: "2px #fff",
            color: "transparent",
          }}
        >
          {data.title}
        </h1>
        <div
          className="text-gray-400 mb-6 text-lg text-center"
          style={{
            textShadow: "0 4px 32px rgba(0,0,0,0.85)"
          }}
        >
          {data.subtitle}
        </div>
        <form className="flex flex-col gap-5" onSubmit={handleSubmit}>
          {data.questions.map((q, idx) => (
            <Input
              key={idx}
              label={q}
              name={`q${idx}`}
              placeholder="–í–∞—à –æ—Ç–≤–µ—Ç..."
              required
              type="text"
            />
          ))}
          {/* <button
            type="submit"
            className="mt-4 mb-4 w-full rounded-xl bg-green-500 hover:bg-green-600 text-white py-3 font-semibold text-lg transition"
          >
            –û—Ç–ø—Ä–∞–≤–∏—Ç—å
          </button> */}
        </form>
        {showError && (
          <div
            style={{
              position: "fixed",
              top: 0,
              left: 0,
              width: "100%",
              height: "100%",
              backdropFilter: "blur(5px)",
              backgroundColor: "rgba(0,0,0,0.3)",
              display: "flex",
              justifyContent: "center",
              alignItems: "center",
              zIndex: 1000,
            }}
          >
            <div
              style={{
                background: "#fff",
                padding: "20px",
                borderRadius: "8px",
                textAlign: "center",
                color: "#000",
              }}
            >
              <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>
              <button onClick={() => setShowError(false)}>–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}